# ç¬¬ä¸‰æ­¥ï¼šå®šæ»‘è½®ä¸åŠ¨æ»‘è½®ç³»ç»Ÿå®ç°

## ç›®æ ‡

å®ç°ç»³å­å¯ä»¥ç»•è¿‡æ»‘è½®ï¼Œæ»‘è½®ä¼šæ—‹è½¬ï¼ŒåŠ¨æ»‘è½®ä¼šè¢«ç»³å­"å…œä½"å¹¶ç§»åŠ¨ï¼Œå®ç°çœŸå®çš„æ»‘è½®ç»„ç‰©ç†æ•ˆæœã€‚

---

## ä»£ç é‡ä¼°ç®—

- `VerletRope.js` æ‰©å±•ï¼šçº¦ 120 è¡Œ
- `physicsEngine.js` ä¿®æ”¹ï¼šçº¦ 100 è¡Œ
- **æ€»è®¡ï¼šçº¦ 220 è¡Œ**

---

## æ ¸å¿ƒç®—æ³•åŸç†

### ç®—æ³•æ¥æº

**å®šæ»‘è½®ç®—æ³•**ï¼š`å®šæ»‘è½®åŠ¨æ»‘è½®å®ç°ç®—æ³•.html` ç¬¬ 242-259 è¡Œ  
**åŠ¨æ»‘è½®ç®—æ³•**ï¼š`å®šæ»‘è½®åŠ¨æ»‘è½®å®ç°ç®—æ³•.html` ç¬¬ 261-299 è¡Œ  
**æ»‘è½®æ—‹è½¬**ï¼š`å®šæ»‘è½®åŠ¨æ»‘è½®å®ç°ç®—æ³•.html` ç¬¬ 317-351 è¡Œ

---

### ç®—æ³• 1ï¼šç»³å­ç»•è¿‡å®šæ»‘è½®

**æ ¸å¿ƒæ€æƒ³**ï¼šç¢°æ’æ£€æµ‹ + ä½ç½®æ ¡æ­£

```
æ¯å¸§æ£€æµ‹ï¼š
  å¯¹äºæ¯ä¸ªç»³å­èŠ‚ç‚¹ï¼š
    1. è®¡ç®—èŠ‚ç‚¹åˆ°æ»‘è½®ä¸­å¿ƒçš„è·ç¦»
    2. å¦‚æœè·ç¦» < æ»‘è½®åŠå¾„ + 2px â†’ èŠ‚ç‚¹è¿›å…¥æ»‘è½®å†…éƒ¨
    3. å°†èŠ‚ç‚¹æ¨åˆ°æ»‘è½®è¾¹ç¼˜ï¼ˆåœ†å‘¨ä¸Šï¼‰
    
ç»“æœï¼šç»³å­è‡ªåŠ¨è´´åˆæ»‘è½®è¡¨é¢ï¼Œå®ç°æ”¹å˜æ–¹å‘
```

**è¯¦ç»†ä»£ç **ï¼š
```javascript
solveFixedPulleyConstraint(pulley) {
  const minDist = pulley.radius + 2;  // ç»³å­ä¸èƒ½è¿›å…¥å†…éƒ¨
  
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    
    // ğŸ”‘ è®¡ç®—èŠ‚ç‚¹åˆ°æ»‘è½®ä¸­å¿ƒçš„è·ç¦»
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    // ğŸ”‘ å¦‚æœè¿›å…¥æ»‘è½®å†…éƒ¨ï¼Œæ¨å‡ºå»
    if (dist < minDist && dist > 0.001) {
      // å½’ä¸€åŒ–æ–¹å‘å‘é‡
      const nx = dx / dist;
      const ny = dy / dist;
      
      // ğŸ”‘ å°†èŠ‚ç‚¹æ”¾åˆ°æ»‘è½®è¾¹ç¼˜
      p.x = pulley.position.x + nx * minDist;
      p.y = pulley.position.y + ny * minDist;
    }
  }
}
```

**æ•ˆæœ**ï¼š
- âœ… ç»³å­ä¸ä¼šç©¿é€æ»‘è½®
- âœ… ç»³å­è‡ªç„¶è´´åˆæ»‘è½®è¾¹ç¼˜
- âœ… ç»³å­æ–¹å‘åœ¨æ»‘è½®å¤„æ”¹å˜

---

### ç®—æ³• 2ï¼šåŠ¨æ»‘è½®è¢«ç»³å­"å…œä½"

**æ ¸å¿ƒæ€æƒ³**ï¼šç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼ˆä½œç”¨åŠ›ä¸åä½œç”¨åŠ›ï¼‰

```
æ¯å¸§è®¡ç®—ï¼š
  1. æ£€æµ‹ç»³å­èŠ‚ç‚¹è¿›å…¥åŠ¨æ»‘è½®å†…éƒ¨
  2. è®¡ç®—ç»³å­æ¨æ»‘è½®çš„åŠ›ï¼ˆåä½œç”¨åŠ›ï¼‰
  3. ç´¯ç§¯æ‰€æœ‰èŠ‚ç‚¹çš„åŠ›
  4. å¯¹åŠ¨æ»‘è½®æ–½åŠ ç´¯ç§¯çš„åŠ›
  
ç»“æœï¼š
  - æ‹–åŠ¨é‡ç‰©å‘ä¸‹ â†’ ç»³å­æ‹‰ç´§ â†’ åŠ¨æ»‘è½®è¢«å‘ä¸Šæ‰˜èµ·
  - å®ç°çœåŠ›æ•ˆæœ
```

**è¯¦ç»†ä»£ç **ï¼š
```javascript
solveMovablePulleyConstraint(pulley) {
  const minDist = pulley.radius + 2;
  let totalForceX = 0;
  let totalForceY = 0;
  
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist < minDist && dist > 0.001) {
      const nx = dx / dist;
      const ny = dy / dist;
      const penetration = minDist - dist;
      
      // 1. æ¨å‡ºç»³å­èŠ‚ç‚¹
      p.x = pulley.position.x + nx * minDist;
      p.y = pulley.position.y + ny * minDist;
      
      // ğŸ”‘ 2. ç´¯ç§¯åä½œç”¨åŠ›
      totalForceX -= nx * penetration;
      totalForceY -= ny * penetration;
    }
  }
  
  // ğŸ”‘ 3. å¯¹åŠ¨æ»‘è½®æ–½åŠ ç´¯ç§¯çš„åŠ›
  if (!pulley.isStatic && pulley.body) {
    const forceScale = 0.00015;  // åŠ›çš„ç¼©æ”¾ç³»æ•°
    Body.applyForce(pulley.body, pulley.position, {
      x: totalForceX * forceScale,
      y: totalForceY * forceScale
    });
  }
}
```

**å…³é”®ç‚¹**ï¼š
- `forceScale = 0.00015`ï¼šåŠ›çš„å¤§å°éœ€è¦ç²¾ç»†è°ƒæ•´
  - å¤ªå¤§ï¼šåŠ¨æ»‘è½®é£èµ·æ¥
  - å¤ªå°ï¼šåŠ¨æ»‘è½®ä¸åŠ¨
- åä½œç”¨åŠ›æ–¹å‘ï¼š`-nx * penetration`ï¼ˆè´Ÿå·è¡¨ç¤ºç›¸åæ–¹å‘ï¼‰

---

### ç®—æ³• 3ï¼šæ»‘è½®æ—‹è½¬è®¡ç®—

**æ ¸å¿ƒæ€æƒ³**ï¼šç»Ÿè®¡ç»³å­èŠ‚ç‚¹çš„å¹³å‡åˆ‡å‘é€Ÿåº¦

```
æ¯å¸§è®¡ç®—ï¼š
  1. æ‰¾åˆ°æ‰€æœ‰åœ¨æ»‘è½®é™„è¿‘çš„ç»³å­èŠ‚ç‚¹
  2. è®¡ç®—è¿™äº›èŠ‚ç‚¹çš„å¹³å‡ç§»åŠ¨é€Ÿåº¦
  3. é€Ÿåº¦è½¬æ¢ä¸ºè§’é€Ÿåº¦
  4. ç´¯åŠ åˆ°æ»‘è½®çš„æ—‹è½¬è§’åº¦
  
ç»“æœï¼šæ»‘è½®æ—‹è½¬æ–¹å‘å’Œé€Ÿåº¦ä¸ç»³å­è¿åŠ¨ä¸€è‡´
```

**è¯¦ç»†ä»£ç **ï¼š
```javascript
updatePulleyRotation(pulley) {
  let avgVelocity = 0;
  let count = 0;
  
  // ğŸ”‘ æ‰¾åˆ°åœ¨æ»‘è½®é™„è¿‘çš„èŠ‚ç‚¹
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    // åªç»Ÿè®¡åœ¨æ»‘è½®é™„è¿‘çš„èŠ‚ç‚¹ï¼ˆåŠå¾„ + 8px èŒƒå›´å†…ï¼‰
    if (dist < pulley.radius + 8) {
      // ğŸ”‘ Verlet é€Ÿåº¦ï¼šå½“å‰ä½ç½® - æ—§ä½ç½®
      avgVelocity += (p.x - p.oldX);
      count++;
    }
  }
  
  if (count > 0) {
    // ğŸ”‘ è½¬æ¢ä¸ºè§’é€Ÿåº¦
    pulley.angle += (avgVelocity / count) * 0.03;
  }
}
```

**ç³»æ•°è¯´æ˜**ï¼š
- `checkRange = radius + 8`ï¼šæ£€æµ‹èŒƒå›´ç¨å¤§äºæ»‘è½®åŠå¾„
- `rotationSpeed = 0.03`ï¼šé€Ÿåº¦åˆ°è§’é€Ÿåº¦çš„è½¬æ¢ç³»æ•°

---

## ä»£ç å®ç°

### æ­¥éª¤ 1ï¼šæ‰©å±• VerletRope.js

åœ¨ `VerletRope` ç±»ä¸­æ·»åŠ æ»‘è½®çº¦æŸæ–¹æ³•ï¼š

```javascript
/**
 * è§£å†³å®šæ»‘è½®çº¦æŸï¼ˆç»³å­ç»•è¿‡å›ºå®šæ»‘è½®ï¼‰
 * @param {Object} pulley - æ»‘è½®å¯¹è±¡
 */
solveFixedPulleyConstraint(pulley) {
  const minDist = pulley.radius + 2;
  
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist < minDist && dist > 0.001) {
      const nx = dx / dist;
      const ny = dy / dist;
      p.x = pulley.position.x + nx * minDist;
      p.y = pulley.position.y + ny * minDist;
    }
  }
}

/**
 * è§£å†³åŠ¨æ»‘è½®çº¦æŸï¼ˆç»³å­"å…œä½"åŠ¨æ»‘è½®ï¼‰
 * @param {Object} pulley - æ»‘è½®å¯¹è±¡
 */
solveMovablePulleyConstraint(pulley) {
  const minDist = pulley.radius + 2;
  let totalForceX = 0;
  let totalForceY = 0;
  
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist < minDist && dist > 0.001) {
      const nx = dx / dist;
      const ny = dy / dist;
      const penetration = minDist - dist;
      
      // æ¨å‡ºèŠ‚ç‚¹
      p.x = pulley.position.x + nx * minDist;
      p.y = pulley.position.y + ny * minDist;
      
      // ç´¯ç§¯åä½œç”¨åŠ›ï¼ˆåªå¯¹åŠ¨æ»‘è½®ï¼‰
      if (!pulley.isStatic) {
        totalForceX -= nx * penetration;
        totalForceY -= ny * penetration;
      }
    }
  }
  
  // å¯¹åŠ¨æ»‘è½®æ–½åŠ åŠ›
  if (!pulley.isStatic && pulley.body) {
    const forceScale = 0.00015;
    Body.applyForce(pulley.body, pulley.position, {
      x: totalForceX * forceScale,
      y: totalForceY * forceScale
    });
  }
}

/**
 * æ›´æ–°æ»‘è½®æ—‹è½¬
 * @param {Object} pulley - æ»‘è½®å¯¹è±¡
 */
updatePulleyRotation(pulley) {
  let avgVelocity = 0;
  let count = 0;
  
  for (let i = 1; i < this.points.length - 1; i++) {
    const p = this.points[i];
    const dx = p.x - pulley.position.x;
    const dy = p.y - pulley.position.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist < pulley.radius + 8) {
      avgVelocity += (p.x - p.oldX);
      count++;
    }
  }
  
  if (count > 0) {
    pulley.angle += (avgVelocity / count) * 0.03;
  }
}

/**
 * æ›´æ–°ç‰©ç†ï¼ˆä¿®æ”¹ç‰ˆï¼Œæ”¯æŒæ»‘è½®ï¼‰
 * @param {Array} pulleys - æ»‘è½®æ•°ç»„
 */
update(pulleys = []) {
  // æ­¥éª¤ 1ï¼šæ›´æ–°é™„ç€ç‚¹
  this.updateAttachments();
  
  // æ­¥éª¤ 2ï¼šVerlet ç§¯åˆ†
  this.updateVerletIntegration();
  
  // æ­¥éª¤ 3ï¼šçº¦æŸæ±‚è§£ï¼ˆå¢åŠ è¿­ä»£æ¬¡æ•°ï¼ŒåŠ å…¥æ»‘è½®çº¦æŸï¼‰
  for (let iter = 0; iter < 20; iter++) {  // ä» 5 å¢åŠ åˆ° 20
    // è·ç¦»çº¦æŸ
    this.solveDistanceConstraints();
    
    // ğŸ”‘ æ»‘è½®çº¦æŸ
    pulleys.forEach(pulley => {
      if (pulley.isStatic) {
        this.solveFixedPulleyConstraint(pulley);
      } else {
        this.solveMovablePulleyConstraint(pulley);
      }
    });
  }
  
  // æ­¥éª¤ 4ï¼šå¯¹åˆšä½“æ–½åŠ æ‹‰åŠ›
  this.applyTensionToBody();
}
```

---

### æ­¥éª¤ 2ï¼šåœ¨ physicsEngine.js ä¸­å¤„ç†æ»‘è½®

```javascript
export function runSimulation({ ... }) {
  
  // ... å‰é¢åˆ›å»ºç‰©ä½“çš„ä»£ç  ...
  
  // ğŸ†• åˆ›å»ºæ»‘è½®æ•°ç»„
  const pulleys = [];
  
  objects.forEach((obj, idx) => {
    // ğŸ”‘ è¯†åˆ«æ»‘è½®
    if (obj.role === 'pulley_fixed' || obj.role === 'pulley_movable') {
      const body = bodies[idx];
      
      // ğŸ”‘ è®¡ç®—æ»‘è½®åŠå¾„ï¼ˆæ ¹æ®è½®å»“å¤§å°ï¼‰
      const bounds = body.bounds;
      const width = bounds.max.x - bounds.min.x;
      const height = bounds.max.y - bounds.min.y;
      const radius = Math.min(width, height) / 2;
      
      // ğŸ”‘ ç¡®ä¿å®šæ»‘è½®æ˜¯é™æ€çš„
      if (obj.role === 'pulley_fixed') {
        Body.setStatic(body, true);
      }
      
      pulleys.push({
        body: body,
        position: body.position,
        radius: radius,
        angle: 0,  // æ—‹è½¬è§’åº¦ï¼ˆç”¨äºæ˜¾ç¤ºè¾æ¡ï¼‰
        isStatic: obj.role === 'pulley_fixed',
        sprite: obj.sprite  // ğŸ”‘ ä¿å­˜ç²¾çµå›¾ä¿¡æ¯
      });
    }
  });
  
  // åˆ›å»ºç»³å­ç³»ç»Ÿ
  const ropeSystems = [];
  constraints.forEach(c => {
    if (c.constraintType === 'rope') {
      // ... åˆ›å»ºç»³å­ ...
      ropeSystems.push(rope);
    }
  });
  
  // ğŸ”‘ æ¸²æŸ“å¾ªç¯ï¼šæ›´æ–°æ»‘è½®ä½ç½®ã€ç»³å­ã€æ»‘è½®æ—‹è½¬
  Events.on(render, 'afterRender', () => {
    const ctx = render.canvas.getContext('2d');
    
    // ğŸ”‘ 1. æ›´æ–°æ»‘è½®ä½ç½®ï¼ˆåŠ¨æ»‘è½®ä¼šç§»åŠ¨ï¼‰
    pulleys.forEach(pulley => {
      pulley.position = pulley.body.position;
    });
    
    // ğŸ”‘ 2. æ›´æ–°å’Œç»˜åˆ¶ç»³å­
    ropeSystems.forEach(rope => {
      rope.update(pulleys);  // ä¼ å…¥æ»‘è½®æ•°ç»„
      rope.render(ctx);
      
      // ğŸ”‘ 3. æ›´æ–°æ»‘è½®æ—‹è½¬
      pulleys.forEach(pulley => {
        rope.updatePulleyRotation(pulley);
      });
    });
    
    // ğŸ”‘ 4. ç»˜åˆ¶æ»‘è½®ï¼ˆå¸¦æ—‹è½¬è¾æ¡ï¼‰
    renderPulleys(ctx, pulleys);
  });
  
  // ... åé¢ä»£ç  ...
}

/**
 * ç»˜åˆ¶æ»‘è½®
 */
function renderPulleys(ctx, pulleys) {
  pulleys.forEach(pulley => {
    ctx.save();
    ctx.translate(pulley.position.x, pulley.position.y);
    ctx.rotate(pulley.angle);  // æ—‹è½¬ç”»å¸ƒ
    
    // ğŸ”‘ å¦‚æœæœ‰ç²¾çµå›¾ï¼Œç»˜åˆ¶ç²¾çµå›¾
    if (pulley.sprite && pulley.sprite.url) {
      // Matter.js ä¼šè‡ªåŠ¨æ¸²æŸ“å¸¦ sprite çš„åˆšä½“
      // è¿™é‡Œåªéœ€è¦ç¡®ä¿æ—‹è½¬åŒæ­¥
      // å®é™…ç²¾çµå›¾æ¸²æŸ“ç”± Matter.js Render å¤„ç†
    } else {
      // ğŸ”‘ æ²¡æœ‰ç²¾çµå›¾æ—¶ï¼Œç»˜åˆ¶ç®€åŒ–çš„æ»‘è½®å›¾å½¢
      
      // å¤–åœˆ
      ctx.beginPath();
      ctx.arc(0, 0, pulley.radius, 0, Math.PI * 2);
      ctx.strokeStyle = pulley.isStatic ? '#00f5ff' : '#00ff88';
      ctx.lineWidth = 3;
      ctx.stroke();
      
      // å‡¹æ§½ï¼ˆç»³å­æ”¾ç½®å¤„ï¼‰
      ctx.beginPath();
      ctx.arc(0, 0, pulley.radius - 4, 0, Math.PI * 2);
      ctx.strokeStyle = 'rgba(255,255,255,0.1)';
      ctx.lineWidth = 6;
      ctx.stroke();
      
      // è¾æ¡ï¼ˆæ˜¾ç¤ºæ—‹è½¬æ•ˆæœï¼‰
      ctx.strokeStyle = pulley.isStatic ? 
        'rgba(0, 245, 255, 0.3)' : 'rgba(0, 255, 136, 0.3)';
      ctx.lineWidth = 2;
      for (let i = 0; i < 5; i++) {
        const angle = (i / 5) * Math.PI * 2;
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(
          Math.cos(angle) * pulley.radius * 0.7,
          Math.sin(angle) * pulley.radius * 0.7
        );
        ctx.stroke();
      }
      
      // ä¸­å¿ƒè½´
      ctx.beginPath();
      ctx.arc(0, 0, 6, 0, Math.PI * 2);
      ctx.fillStyle = pulley.isStatic ? '#00f5ff' : '#00ff88';
      ctx.fill();
    }
    
    ctx.restore();
    
    // ğŸ”‘ æ ‡ç­¾ï¼ˆå¯é€‰ï¼Œå¦‚æœéœ€è¦ï¼‰
    if (!pulley.sprite) {
      ctx.font = 'bold 12px monospace';
      ctx.fillStyle = pulley.isStatic ? '#00f5ff' : '#00ff88';
      ctx.textAlign = 'center';
      ctx.fillText(
        pulley.isStatic ? 'å®šæ»‘è½®' : 'åŠ¨æ»‘è½®',
        pulley.position.x,
        pulley.position.y - pulley.radius - 10
      );
    }
  });
}
```

---

## å®Œæˆåçš„å‰ç«¯æ•ˆæœï¼ˆè¯¦ç»†ï¼‰

### é˜¶æ®µä¸€ï¼šåˆ›å»ºåŒ…å«æ»‘è½®çš„åœºæ™¯

**åœºæ™¯è®¾ç½®**ï¼š
- ä¸Šä¼ åŒ…å«æ»‘è½®çš„å›¾ç‰‡
- å¤§æ¨¡å‹è¯†åˆ«å‡ºå®šæ»‘è½®æˆ–åŠ¨æ»‘è½®
- åç«¯è¿”å› `role: "pulley_fixed"` æˆ– `"pulley_movable"`

1. **ç”¨æˆ·é€‰æ‹©æ»‘è½®**ï¼š
   - åƒé€‰æ‹©æ™®é€šåˆšä½“ä¸€æ ·æ¡†é€‰æ»‘è½®
   - ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«ä¸ºæ»‘è½®ç±»å‹

---

### é˜¶æ®µäºŒï¼šåˆ›å»ºç»³å­ç»•è¿‡æ»‘è½®

2. **ç»³å­è¿æ¥æµç¨‹**ï¼š
   - é€‰æ‹©"ç»³å­"å·¥å…·
   - ç‚¹å‡»å›ºå®šç‚¹ï¼ˆå¦‚å¢™ä¸Šï¼‰
   - ç§»åŠ¨é¼ æ ‡ï¼Œå¸ƒå±€ç»³å­è·¯å¾„
   - ç‚¹å‡»åŠ¨æ»‘è½®
   - ç»§ç»­ç§»åŠ¨é¼ æ ‡
   - ç‚¹å‡»å®šæ»‘è½®
   - ç»§ç»­ç§»åŠ¨é¼ æ ‡
   - ç‚¹å‡»é‡ç‰©

3. **è·¯å¾„é¢„è§ˆ**ï¼š
   - é»‘è‰²è™šçº¿è·Ÿéšé¼ æ ‡
   - å¯ä»¥çœ‹åˆ°ç»³å­ä¼šç»è¿‡å“ªäº›æ»‘è½®
   - çº¢è‰²åœ†ç‚¹æ ‡è®°èµ·ç‚¹
   - ç»¿è‰²åœ†ç‚¹è·Ÿéšé¼ æ ‡

---

### é˜¶æ®µä¸‰ï¼šç‚¹å‡»"åˆ›å»ºæ¨¡æ‹Ÿ"åçš„åˆå§‹çŠ¶æ€

4. **ä½ èƒ½çœ‹åˆ°**ï¼š
   - **å®šæ»‘è½®**ï¼š
     - åœ†å½¢è½®å»“ï¼ˆè“è‰²è¾¹æ¡†ï¼Œ#00f5ffï¼‰
     - 5 æ¡è¾æ¡ï¼ˆè“è‰²åŠé€æ˜ï¼‰
     - ä¸­å¿ƒæœ‰åœ†å½¢è½´ï¼ˆè“è‰²å®å¿ƒï¼‰
     - ä¸Šæ–¹æ ‡ç­¾ï¼š"å®šæ»‘è½®"
     - ä½ç½®å›ºå®šä¸åŠ¨
   
   - **åŠ¨æ»‘è½®**ï¼š
     - åœ†å½¢è½®å»“ï¼ˆç»¿è‰²è¾¹æ¡†ï¼Œ#00ff88ï¼‰
     - 5 æ¡è¾æ¡ï¼ˆç»¿è‰²åŠé€æ˜ï¼‰
     - ä¸­å¿ƒæœ‰åœ†å½¢è½´ï¼ˆç»¿è‰²å®å¿ƒï¼‰
     - ä¸Šæ–¹æ ‡ç­¾ï¼š"åŠ¨æ»‘è½®"
     - å—é‡åŠ›å½±å“

5. **ç»³å­ä¸æ»‘è½®çš„å…³ç³»**ï¼š
   - ç»³å­**ç´§è´´æ»‘è½®è¾¹ç¼˜**
   - ç»³å­ä¸ä¼šè¿›å…¥æ»‘è½®å†…éƒ¨
   - ç»³å­åœ¨æ»‘è½®å¤„**æ”¹å˜æ–¹å‘**
   - ç»³å­é¢œè‰²ï¼šé»‘è‰²ï¼ˆ#000000ï¼‰

---

### é˜¶æ®µå››ï¼šæ‹–æ‹½é‡ç‰©ï¼ˆè§‚å¯Ÿæ»‘è½®æ•ˆæœï¼‰

**æµ‹è¯•åœºæ™¯**ï¼šå›ºå®šç‚¹ â†’ åŠ¨æ»‘è½® â†’ å®šæ»‘è½® â†’ é‡ç‰©

6. **æ‹–åŠ¨é‡ç‰©å‘ä¸‹**ï¼š
   - **ç»³å­å˜åŒ–**ï¼š
     - ç»³å­è¢«æ‹‰ç›´
     - ç»³å­é•¿åº¦ä¸å˜ï¼ˆç´§ç»·çŠ¶æ€ï¼‰
   
   - **åŠ¨æ»‘è½®ååº”**ï¼š
     - ğŸ”‘ åŠ¨æ»‘è½®**å‘ä¸Šç§»åŠ¨**ï¼ˆè¢«ç»³å­æ‰˜èµ·ï¼‰
     - åŠ¨æ»‘è½®çš„ç»¿è‰²è¾æ¡**æ—‹è½¬**
     - ç§»åŠ¨é€Ÿåº¦çº¦ä¸ºé‡ç‰©é€Ÿåº¦çš„ä¸€åŠï¼ˆçœåŠ›åŸç†ï¼‰
   
   - **å®šæ»‘è½®ååº”**ï¼š
     - å®šæ»‘è½®**ä½ç½®ä¸å˜**
     - å®šæ»‘è½®çš„è“è‰²è¾æ¡**æ—‹è½¬**
     - æ—‹è½¬æ–¹å‘ä¸ç»³å­è¿åŠ¨æ–¹å‘ä¸€è‡´

7. **æ‹–åŠ¨é‡ç‰©å‘ä¸Š**ï¼š
   - åŠ¨æ»‘è½®**å‘ä¸‹ç§»åŠ¨**
   - ä¸¤ä¸ªæ»‘è½®**åå‘æ—‹è½¬**
   - ç»³å­å§‹ç»ˆè´´åˆæ»‘è½®è¾¹ç¼˜

---

### é˜¶æ®µäº”ï¼šæ¾æ‰‹åçš„è¿åŠ¨

8. **é‡ç‰©æ‰è½**ï¼š
   - é‡ç‰©å—é‡åŠ›æ‰è½
   - æ‹‰åŠ¨ç»³å­å‘ä¸‹
   - åŠ¨æ»‘è½®è¢«æ‹‰åŠ¨**å‘ä¸Š**
   - ä¸¤ä¸ªæ»‘è½®**æŒç»­æ—‹è½¬**

9. **æ»‘è½®æ—‹è½¬ç»†èŠ‚**ï¼š
   - **å®šæ»‘è½®**ï¼š
     - è¾æ¡é¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆæ—‹è½¬
     - æ—‹è½¬é€Ÿåº¦å–å†³äºç»³å­é€Ÿåº¦
     - å¯ä»¥æ¸…æ¥šçœ‹åˆ°è¾æ¡å˜åŒ–
   
   - **åŠ¨æ»‘è½®**ï¼š
     - è¾æ¡ä¹Ÿåœ¨æ—‹è½¬
     - åŒæ—¶æ•´ä¸ªæ»‘è½®åœ¨ä¸Šä¸‹ç§»åŠ¨
     - æ—¢æœ‰å¹³åŠ¨åˆæœ‰è½¬åŠ¨

---

### é˜¶æ®µå…­ï¼šè§‚å¯Ÿç‰©ç†ç»†èŠ‚

10. **ç»³å­ä¸æ»‘è½®çš„è´´åˆ**ï¼š
    - æ”¾å¤§è§‚å¯Ÿæ»‘è½®è¾¹ç¼˜
    - ç»³å­**å®Œå…¨è´´åˆ**æ»‘è½®åœ†å‘¨
    - æ²¡æœ‰é—´éš™
    - æ²¡æœ‰ç©¿é€

11. **åŠ¨æ»‘è½®çš„çœåŠ›æ•ˆæœ**ï¼š
    - æ‹–åŠ¨é‡ç‰©éœ€è¦çš„åŠ›æ˜æ˜¾å˜å°
    - é‡ç‰©ç§»åŠ¨è·ç¦»æ˜¯åŠ¨æ»‘è½®çš„ 2 å€
    - ç¬¦åˆæ»‘è½®ç»„åŸç†

12. **æ»‘è½®æ—‹è½¬çš„çœŸå®æ€§**ï¼š
    - æ—‹è½¬æ–¹å‘æ­£ç¡®
    - æ—‹è½¬é€Ÿåº¦åˆç†
    - åœæ­¢æ—¶æ»‘è½®é€æ¸åœè½¬ï¼ˆæœ‰æƒ¯æ€§ï¼‰

---

### é˜¶æ®µä¸ƒï¼šå®šæ»‘è½® vs åŠ¨æ»‘è½®å¯¹æ¯”

| ç‰¹æ€§ | å®šæ»‘è½® | åŠ¨æ»‘è½® |
|------|--------|--------|
| **é¢œè‰²** | è“è‰² (#00f5ff) | ç»¿è‰² (#00ff88) |
| **ä½ç½®** | å›ºå®šä¸åŠ¨ | å¯ä»¥ç§»åŠ¨ |
| **æ—‹è½¬** | âœ… ä¼šæ—‹è½¬ | âœ… ä¼šæ—‹è½¬ |
| **æ ‡ç­¾** | "å®šæ»‘è½®" | "åŠ¨æ»‘è½®" |
| **ä½œç”¨** | æ”¹å˜åŠ›çš„æ–¹å‘ | çœåŠ›ï¼ˆè¢«ç»³å­æ‰˜ä½ï¼‰ |
| **æ‹–æ‹½** | âŒ ä¸å¯æ‹–æ‹½ | âœ… å¯æ‹–æ‹½ |
| **Matter.js** | isStatic: true | isStatic: false |

---

## æµ‹è¯•åœºæ™¯

### æµ‹è¯• 1ï¼šå•ä¸ªå®šæ»‘è½®

**åœºæ™¯è®¾ç½®**ï¼š
- å›ºå®šç‚¹ï¼ˆå¤©èŠ±æ¿ï¼‰â†’ å®šæ»‘è½® â†’ é‡ç‰©
- ç»³å­è·¯å¾„ï¼šä»ä¸Šæ–¹å›ºå®šç‚¹ï¼Œç»•è¿‡å®šæ»‘è½®ï¼Œè¿æ¥é‡ç‰©

**æ“ä½œæ­¥éª¤**ï¼š
1. åˆ›å»ºæ¨¡æ‹Ÿ
2. è§‚å¯Ÿé‡ç‰©æ‰è½
3. è§‚å¯Ÿå®šæ»‘è½®æ˜¯å¦æ—‹è½¬

**é¢„æœŸæ•ˆæœ**ï¼š
- âœ… å®šæ»‘è½®ä½ç½®å›ºå®š
- âœ… å®šæ»‘è½®æ—‹è½¬ï¼ˆè¾æ¡å˜åŒ–ï¼‰
- âœ… ç»³å­è´´åˆæ»‘è½®è¾¹ç¼˜
- âœ… é‡ç‰©æ‰è½ï¼Œæ‹‰åŠ¨ç»³å­

---

### æµ‹è¯• 2ï¼šå•ä¸ªåŠ¨æ»‘è½®

**åœºæ™¯è®¾ç½®**ï¼š
- å›ºå®šç‚¹ â†’ åŠ¨æ»‘è½®ï¼ˆä¸‹æ–¹ï¼‰â†’ å›ºå®šç‚¹
- é‡ç‰©æŒ‚åœ¨åŠ¨æ»‘è½®ä¸Š

**æ“ä½œæ­¥éª¤**ï¼š
1. åˆ›å»ºæ¨¡æ‹Ÿ
2. æ‹–åŠ¨åŠ¨æ»‘è½®å‘ä¸‹
3. æ¾æ‰‹è§‚å¯Ÿ

**é¢„æœŸæ•ˆæœ**ï¼š
- âœ… åŠ¨æ»‘è½®è¢«ç»³å­æ‰˜ä½ï¼ˆä¸ä¼šæ‰è½ï¼‰
- âœ… æ‹–åŠ¨æ—¶ç»³å­æ‹‰ç´§
- âœ… æ¾æ‰‹ååŠ¨æ»‘è½®å›å¼¹
- âœ… åŠ¨æ»‘è½®æ—‹è½¬

---

### æµ‹è¯• 3ï¼šæ»‘è½®ç»„ï¼ˆå®šæ»‘è½® + åŠ¨æ»‘è½®ï¼‰

**åœºæ™¯è®¾ç½®**ï¼š
- å›ºå®šç‚¹ â†’ åŠ¨æ»‘è½® â†’ å®šæ»‘è½® â†’ é‡ç‰©

**æ“ä½œæ­¥éª¤**ï¼š
1. åˆ›å»ºæ¨¡æ‹Ÿ
2. æ‹–åŠ¨é‡ç‰©å‘ä¸‹
3. è§‚å¯ŸåŠ¨æ»‘è½®ç§»åŠ¨æ–¹å‘
4. è§‚å¯Ÿä¸¤ä¸ªæ»‘è½®æ˜¯å¦éƒ½æ—‹è½¬

**é¢„æœŸæ•ˆæœ**ï¼š
- âœ… æ‹–åŠ¨é‡ç‰©å‘ä¸‹ â†’ åŠ¨æ»‘è½®å‘ä¸Š
- âœ… å®šæ»‘è½®å›ºå®šï¼Œåªæ—‹è½¬
- âœ… åŠ¨æ»‘è½®ç§»åŠ¨ + æ—‹è½¬
- âœ… ä¸¤ä¸ªæ»‘è½®æ—‹è½¬æ–¹å‘æ­£ç¡®
- âœ… çœåŠ›æ•ˆæœæ˜æ˜¾

---

### æµ‹è¯• 4ï¼šç»³å­è·¯å¾„å¤æ‚å¸ƒå±€

**åœºæ™¯è®¾ç½®**ï¼š
- ç»³å­ç»•è¿‡å¤šä¸ªæ»‘è½®

**æ“ä½œæ­¥éª¤**ï¼š
1. åˆ›å»ºç»³å­æ—¶ï¼Œé¼ æ ‡è·¯å¾„æ•…æ„ç»•åœˆ
2. è§‚å¯Ÿç»³å­æ˜¯å¦è´´åˆæ‰€æœ‰æ»‘è½®

**é¢„æœŸæ•ˆæœ**ï¼š
- âœ… ç»³å­è´´åˆæ‰€æœ‰æ»‘è½®
- âœ… æ‰€æœ‰æ»‘è½®éƒ½ä¼šæ—‹è½¬
- âœ… è·¯å¾„å¤æ‚ä½†ç‰©ç†æ­£ç¡®

---

## å‚æ•°è°ƒä¼˜æŒ‡å—

### å‚æ•° 1ï¼šåŠ¨æ»‘è½®åŠ›çš„å¤§å°

```javascript
const forceScale = 0.00015;  // é»˜è®¤å€¼
```

**è°ƒæ•´å»ºè®®**ï¼š
- å¤ªå°ï¼ˆ< 0.0001ï¼‰ï¼šåŠ¨æ»‘è½®ä¸åŠ¨ï¼Œç»³å­ç©¿é€
- å¤ªå¤§ï¼ˆ> 0.0003ï¼‰ï¼šåŠ¨æ»‘è½®é£èµ·æ¥ï¼Œä¸ç¨³å®š
- **æ¨èèŒƒå›´**ï¼š0.00012 - 0.0002

**æµ‹è¯•æ–¹æ³•**ï¼š
1. æ‹–åŠ¨é‡ç‰©å‘ä¸‹
2. è§‚å¯ŸåŠ¨æ»‘è½®æ˜¯å¦å¹³ç¨³ä¸Šå‡
3. å¦‚æœåŠ¨æ»‘è½®æŠ–åŠ¨ â†’ é™ä½ forceScale
4. å¦‚æœåŠ¨æ»‘è½®ä¸åŠ¨ â†’ å¢åŠ  forceScale

---

### å‚æ•° 2ï¼šæ»‘è½®åŠå¾„æ£€æµ‹èŒƒå›´

```javascript
const minDist = pulley.radius + 2;  // æ¨å‡ºè·ç¦»
const checkRange = pulley.radius + 8;  // æ—‹è½¬æ£€æµ‹èŒƒå›´
```

**è°ƒæ•´å»ºè®®**ï¼š
- `minDist`ï¼šæ¨è radius + 2 åˆ° radius + 4
- `checkRange`ï¼šæ¨è radius + 6 åˆ° radius + 10

---

### å‚æ•° 3ï¼šçº¦æŸæ±‚è§£è¿­ä»£æ¬¡æ•°

```javascript
for (let iter = 0; iter < 20; iter++) {  // è¿­ä»£æ¬¡æ•°
```

**è°ƒæ•´å»ºè®®**ï¼š
- å¤ªå°‘ï¼ˆ< 10ï¼‰ï¼šç»³å­å¯èƒ½ç©¿é€æ»‘è½®
- å¤ªå¤šï¼ˆ> 30ï¼‰ï¼šæ€§èƒ½ä¸‹é™
- **æ¨èèŒƒå›´**ï¼š15 - 25

---

### å‚æ•° 4ï¼šæ»‘è½®æ—‹è½¬é€Ÿåº¦

```javascript
pulley.angle += (avgVelocity / count) * 0.03;  // æ—‹è½¬ç³»æ•°
```

**è°ƒæ•´å»ºè®®**ï¼š
- å¤ªå°ï¼ˆ< 0.01ï¼‰ï¼šæ—‹è½¬å¤ªæ…¢ï¼Œä¸æ˜æ˜¾
- å¤ªå¤§ï¼ˆ> 0.05ï¼‰ï¼šæ—‹è½¬å¤ªå¿«ï¼Œä¸çœŸå®
- **æ¨èèŒƒå›´**ï¼š0.02 - 0.04

---

## å¸¸è§é—®é¢˜

### Q1ï¼šç»³å­ç©¿é€æ»‘è½®ï¼Ÿ

**åŸå› **ï¼š
- è¿­ä»£æ¬¡æ•°å¤ªå°‘
- æˆ– `minDist` è®¾ç½®ä¸å¯¹

**è§£å†³**ï¼š
```javascript
// å¢åŠ è¿­ä»£æ¬¡æ•°
for (let iter = 0; iter < 20; iter++) {

// æ£€æŸ¥ minDist
const minDist = pulley.radius + 3;  // ç¨å¾®å¢å¤§
```

---

### Q2ï¼šåŠ¨æ»‘è½®ä¸åŠ¨æˆ–æŠ–åŠ¨ä¸¥é‡ï¼Ÿ

**åŸå› **ï¼š`forceScale` ä¸åˆé€‚

**è§£å†³**ï¼šé€æ­¥è°ƒæ•´
```javascript
// ä»å°å¼€å§‹è°ƒæ•´
const forceScale = 0.00010;  // å…ˆæµ‹è¯•
// è§‚å¯Ÿæ•ˆæœï¼Œé€æ­¥å¢åŠ åˆ° 0.00015
```

---

### Q3ï¼šæ»‘è½®ä¸æ—‹è½¬ï¼Ÿ

**åŸå› **ï¼šç»³å­èŠ‚ç‚¹æ²¡æœ‰ç»è¿‡æ»‘è½®é™„è¿‘

**æ£€æŸ¥**ï¼š
```javascript
// ç¡®ä¿è¿™æ®µä»£ç å­˜åœ¨
if (dist < pulley.radius + 8) {
  avgVelocity += (p.x - p.oldX);
  count++;
}
```

---

### Q4ï¼šåŠ¨æ»‘è½®é£èµ·æ¥ï¼Ÿ

**åŸå› **ï¼šåŠ›å¤ªå¤§æˆ–è´¨é‡å¤ªå°

**è§£å†³**ï¼š
```javascript
// é™ä½åŠ›
const forceScale = 0.00008;

// æˆ–å¢åŠ åŠ¨æ»‘è½®è´¨é‡
density: 0.005  // å¢åŠ å¯†åº¦
```

---

## ä¸‹ä¸€æ­¥

å®Œæˆç¬¬ä¸‰æ­¥åï¼Œè¿›å…¥ï¼š
**äº¤äº’æ¨¡å¼å®ç°-ç¬¬å››æ­¥-è½´å¿ƒè½»æ†.md**

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**é¢„è®¡å¼€å‘æ—¶é—´**ï¼š2-3 å¤©

